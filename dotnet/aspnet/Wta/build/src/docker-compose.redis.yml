include: [ "docker-compose.include.yml" ]

services:
  redis:
    image: ${REDIS}
    extends:
      file: docker-compose.extend.yml
      service: base
    networks:
      net:
        ipv4_address: ${REDIS_IP}
    environment:
      - REDIS_PASSWORD=aA123456!
    ports:
      - ${REDIS_PORT}:6379
    volumes:
      - ./apps/redis/redis.conf:/usr/local/etc/redis/redis.conf
      - ${DATA}/redis:/data
    command: ["redis-server", "/usr/local/etc/redis/redis.conf"]
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
  redisinsight:
    image: ${REDISINSIGHT}
    extends:
      file: docker-compose.extend.yml
      service: base
    networks:
      net:
        ipv4_address: ${REDISINSIGHT_IP}
    ports:
      - 5540:5540
    volumes:
      - ${DATA}/redisinsight:/data
    depends_on:
      redis:
        condition: service_healthy
