include: [ "docker-compose.include.yml" ]

services:
  seatunnel-master:
    image: ${SEATUNNEL}
    extends:
      file: docker-compose.extend.yml
      service: base
    networks:
      net:
        ipv4_address: ${SEATUNNEL_IP}
    environment:
      - ST_DOCKER_MEMBER_LIST= ${SEATUNNEL_IP}, ${SEATUNNEL_IP1}, ${SEATUNNEL_IP2}
    entrypoint: >
      /bin/sh -c " /opt/seatunnel/bin/seatunnel-cluster.sh -r master "    
    ports:
      - 5801:5801

  seatunnel-worker1:
    image: ${SEATUNNEL}
    extends:
      file: docker-compose.extend.yml
      service: base
    networks:
      net:
        ipv4_address: ${SEATUNNEL_IP1}
    environment:
      - ST_DOCKER_MEMBER_LIST= ${SEATUNNEL_IP}, ${SEATUNNEL_IP1}, ${SEATUNNEL_IP2}
    entrypoint: >
      /bin/sh -c " /opt/seatunnel/bin/seatunnel-cluster.sh -r worker " 
    depends_on:
      - seatunnel-master

  seatunnel-worker2:
    image: ${SEATUNNEL}
    extends:
      file: docker-compose.extend.yml
      service: base
    networks:
      net:
        ipv4_address: ${SEATUNNEL_IP2}
    environment:
      - ST_DOCKER_MEMBER_LIST= ${SEATUNNEL_IP}, ${SEATUNNEL_IP1}, ${SEATUNNEL_IP2}
    entrypoint: >
      /bin/sh -c " /opt/seatunnel/bin/seatunnel-cluster.sh -r worker " 
    depends_on:
      - seatunnel-master

  seatunnel-web:
    image: cafuc/seatunnel-web:1.0.2
    ports:
      - 8801:8801
